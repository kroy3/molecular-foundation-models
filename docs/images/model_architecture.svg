<svg width="600" height="700" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="300" y="30" font-size="22" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Hybrid EGNN-PaiNN Architecture
  </text>
  
  <!-- Input -->
  <g>
    <rect x="200" y="60" width="200" height="50" fill="#ecf0f1" stroke="#95a5a6" stroke-width="2" rx="5"/>
    <text x="300" y="80" font-size="14" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Input: Molecular Graph
    </text>
    <text x="300" y="98" font-size="11" text-anchor="middle" fill="#7f8c8d">
      {positions, atom_types, edges}
    </text>
  </g>
  
  <!-- Arrow -->
  <path d="M 300 110 L 300 140" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- EGNN Block 1 -->
  <g>
    <rect x="150" y="140" width="300" height="80" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
    <text x="300" y="165" font-size="16" font-weight="bold" text-anchor="middle" fill="white">
      EGNN Layer 1
    </text>
    <text x="300" y="188" font-size="12" text-anchor="middle" fill="white">
      Message Passing: m_ij = φ(h_i, h_j, ||x_i - x_j||²)
    </text>
    <text x="300" y="208" font-size="12" text-anchor="middle" fill="white">
      Update: h_i' = φ_h(h_i, Σ_j m_ij)
    </text>
  </g>
  
  <!-- Arrow -->
  <path d="M 300 220 L 300 250" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- EGNN Block 2 -->
  <g>
    <rect x="150" y="250" width="300" height="60" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
    <text x="300" y="275" font-size="16" font-weight="bold" text-anchor="middle" fill="white">
      EGNN Layer 2-4
    </text>
    <text x="300" y="298" font-size="12" text-anchor="middle" fill="white">
      Repeated geometric feature extraction
    </text>
  </g>
  
  <!-- Arrow -->
  <path d="M 300 310 L 300 340" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- PaiNN Block 1 -->
  <g>
    <rect x="150" y="340" width="300" height="80" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
    <text x="300" y="365" font-size="16" font-weight="bold" text-anchor="middle" fill="white">
      PaiNN Layer 1
    </text>
    <text x="300" y="388" font-size="12" text-anchor="middle" fill="white">
      Message: s_ij, v_ij = f_msg(s_i, v_i, s_j, v_j, r_ij)
    </text>
    <text x="300" y="408" font-size="12" text-anchor="middle" fill="white">
      Update: s_i', v_i' = f_upd(s_i, v_i, Σ_j s_ij, Σ_j v_ij)
    </text>
  </g>
  
  <!-- Arrow -->
  <path d="M 300 420 L 300 450" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- PaiNN Block 2 -->
  <g>
    <rect x="150" y="450" width="300" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
    <text x="300" y="475" font-size="16" font-weight="bold" text-anchor="middle" fill="white">
      PaiNN Layer 2-3
    </text>
    <text x="300" y="498" font-size="12" text-anchor="middle" fill="white">
      Equivariant convolutions for physics
    </text>
  </g>
  
  <!-- Arrow -->
  <path d="M 300 510 L 300 540" stroke="#34495e" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- Task Heads -->
  <g>
    <rect x="100" y="540" width="160" height="80" fill="#27ae60" stroke="#229954" stroke-width="2" rx="5"/>
    <text x="180" y="565" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
      Energy Head
    </text>
    <text x="180" y="588" font-size="11" text-anchor="middle" fill="white">
      E = MLP(Σ_i h_i)
    </text>
    <text x="180" y="608" font-size="11" text-anchor="middle" fill="white">
      Output: Scalar
    </text>
  </g>
  
  <g>
    <rect x="340" y="540" width="160" height="80" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
    <text x="420" y="565" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
      HOMO-LUMO Head
    </text>
    <text x="420" y="588" font-size="11" text-anchor="middle" fill="white">
      ΔE = MLP(h_global)
    </text>
    <text x="420" y="608" font-size="11" text-anchor="middle" fill="white">
      Output: Scalar
    </text>
  </g>
  
  <!-- Key Features Box -->
  <g>
    <rect x="50" y="640" width="500" height="50" fill="#f8f9fa" stroke="#dee2e6" stroke-width="2" rx="5"/>
    <text x="300" y="660" font-size="13" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Key: SE(3) Equivariant • Multi-Scale • Physics-Aware • 2.1M Parameters
    </text>
    <text x="300" y="678" font-size="11" text-anchor="middle" fill="#7f8c8d">
      Hidden dim: 128 | Vector dim: 64 | Layers: 5 EGNN + 3 PaiNN
    </text>
  </g>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#34495e"/>
    </marker>
  </defs>
</svg>
